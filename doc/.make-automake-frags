#!/bin/sh
# invoked by $(top_srcdir)/autogen.sh in this directory

xtab='s/@TAB@/	/g'                     # embedded tab!

spew_twerp_stuff ()
{
stems=$1

set \
  '
  1i\
ALL_TWERPS = \\
  s/.*/  &.twerp/
  $!s/$/ \\/
  ' \
  '
  s/.*/&.texi : &.twerp/
  ' \
  '
  1i\
remove-twerp-shadowed-texi:
  s,.*,@TAB@rm -f $(distdir)/&.texi,
  '

for p ; do sed "$p;$xtab" $stems ; done
}

prep_dummy_texi ()
{
stems=$1
for stem in `cat $stems` ; do
  texi=$stem.texi
  if [ ! -f $texi ] ; then
    echo '@setfilename guile-pg.info' > $texi
    touch -m -t 01010000 $texi
  fi
done
}

main ()
{
spew_twerp_stuff .twerp-list > twerp.mk-am-frag
prep_dummy_texi .twerp-list
}

main

# .make-automake-frags ends here
