2002-12-22  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* scm/postgres-types.scm (oid-type-name-cache): New proc, exported.

2002-12-22  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* libpostgres.c (pgrs): Move PGRES_TUPLES_OK first.

2002-12-22  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* doc/guile-pg.texi (Miscellaneous): Add intro blurb.

2002-12-21  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* configure.in: Add check for `terminating' in libguile; define
	HAVE_LIBGUILE_TERMINATING in config.h if available.

	* libpostgres_lo.c: When not HAVE_SCM_TERMINATING, only declare
	`terminating' if also HAVE_LIBGUILE_TERMINATING.
	(lob_flush): On error, if neither HAVE_SCM_TERMINATING nor
	HAVE_LIBGUILE_TERMINATING, unconditionally write to stderr.

2002-12-20  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* configure.in (VERSION): Bump to 0.12 for release.

2002-12-20  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* scm/Makefile.am (EXTRA_DIST): Add $(guile_postgres_sources).

2002-12-20  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* doc/guile-pg.texi (Types Conversion,
	Single-Table Abstraction): New nodes/chapters.

2002-12-20  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* scm/postgres-types.scm (dbcoltypes): New proc, exported.

2002-12-20  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* test/abstraction-scm-tests.sh: New file.
	* test/guile-pg-abstraction-scm-tests.scm: New file.

	* test/Makefile.am (TESTS): Add abstraction-scm-tests.sh.
	(CLEANFILES): Add abstraction-scm-tests.log.
	(EXTRA_DIST): Remove alive.sh, basic-tests.sh, lo-tests.sh,
	guile-pg-basic-tests.scm.in, guile-pg-lo-tests.scm.in.
	Add $(TESTS) and guile-pg-abstraction-scm-tests.scm.
	(DISTCLEANFILES): Delete directive.

2002-12-20  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* scm/postgres-table.scm: New file.
	* scm/Makefile.am (guile_postgres_sources): Add postgres-table.scm.

2002-12-20  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* scm/postgres-types.scm: New file.
	* scm/Makefile.am (guile_postgres_sources): Add postgres-types.scm.

2002-12-19  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* HACKING: Mention test/cov.

2002-12-18  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* test/alive.sh: Use guile exit val for script exit val.
	* test/basic-tests.sh: Likewise.
	* test/lo-tests.sh: Likewise.

2002-12-18  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* test/guile-pg-lo-tests.scm.in: Look for testing.scm in @srcdir@.
	* test/guile-pg-basic-tests.scm.in: Likewise.

2002-12-17  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* doc/Makefile.am (EXTRA_DIST): New var.

	* test/Makefile.am (EXTRA_DIST): Add cov.

2002-12-17  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* doc/Makefile.am (dist-hook): New directive.
	* test/Makefile.am: Likewise.

2002-12-17  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* configure.in (VERSION): Bump to 0.11 for release.

2002-12-17  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* configure.in (HAVE_SCM_TERMINATING): Arrange to define this
	config.h macro if libguile.h declares `scm_terminating'.

	* libpostgres_lo.c (scm_terminating): Rename from `terminating',
	but only declare if HAVE_SCM_TERMINATING is not defined.  Use
	"extern int" in that case.

2002-12-16  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* THANKS: New file.
	* Makefile.am (EXTRA_DIST): Add THANKS.

2002-12-16  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* configure.in: Add multiple checks for `InvalidOid' decl.
	Signal error if not found.

	* libpostgres.c (INVALIDOID_HEADER): #include this if defined.

2002-12-16  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* acinclude.m4: Use m4 quoting (square braces)
	instead of shell quoting (double quotes).

2002-12-14  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* Makefile.am (EXTRA_DIST): Add contrib.
	(dist-hook): New directive.

	* configure.in (VERSION): Bump to 0.10 for release.

2002-12-14  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* libpostgres_lo.c (lob_seek): Only adjust return value on SEEK_CUR.
	(lob_lo_seek): No longer construct args for, or
	call, `lo_lseek'; use `lob_seek' instead.

	* test/guile-pg-lo-tests.scm.in (test:lo-tell): Also check
	equivalency of "seek 0 SEEK_CUR".

2002-12-14  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* autogen.sh: Invoke "libtoolize --force" if no ltmain.sh in cwd.

2002-12-14  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* libpostgres_lo.c (lob_seek): Adjust return value by the amount
	in the port's read-buffer between the read_pos and read_end.

	* guile-pg-lo-tests.scm.in (test:lo-tell): New proc, run by `test'.
	(test:make-connection): Use `->bool' instead of `if'.
	(test:lo-open-read): Also test `pg-lo-get-connection'.

2002-12-13  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* doc/cov, test/cov: New maintenance scripts.

2002-12-13  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* test/guile-pg-lo-tests.scm.in: Delete files "lo-tests-data-1"
	and "lo-tests-data-2" when done.

2002-12-13  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* test/guile-pg-lo-tests.scm.in, test/guile-pg-basic-tests.scm.in:
	Rework "if" constructs using "and".  Refill.

2002-12-13  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* libpostgres.c (MAX_SSI): Delete macro.
	(ser_status_str, ser_status_str_count, ser_status): Delete vars.
	(pgrs_t): New typedef.
	(pgrs, pgrs_count): New vars, static.
	(ser_display): Replace `ser_status' and `ser_status_str' lookup
	with `pgrs' lookup.
	(str2symbol): Delete macro.
	(pg_result_status): No longer create symbol; use `pgrs' for lookup.
	(init_postgres): No longer define PGRES_* vars.
	Instead, initialize `sym' field in `pgrs'.

2002-12-13  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* libpostgres.c, libpostres_lo.c: Refill; nfc.

2002-12-12  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* configure.in (VERSION): Bump to 0.09 for release.

2002-12-12  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* scm/postgres.scm.in (PGRES_EMPTY_QUERY, PGRES_COMMAND_OK,
	PGRES_TUPLES_OK, PGRES_COPY_OUT, PGRES_COPY_IN,
	PGRES_BAD_RESPONSE, PGRES_NONFATAL_ERROR, PGRES_FATAL_ERROR):
	New vars, exported.

2002-12-12  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* doc/guile-pg.texi (Concept Index): Comment out node.
	(Programming Interface): Delete node; move children up.

2002-12-12  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* doc/guile-pg.texi: Rewrite "function" as "procedure".
	Replace @defun with "@deffn {Scheme Procedure}".
	Convert	"returns" -> "return" and so on.
	Move "Miscellaneous" after the other peer sections.
	Refill @lisp examples.

2002-12-12  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* doc/guile-pg.texi: Update copyright.
	Refill; nfc.

2002-12-11  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* configure.in (VERSION): Bump to 0.08 for release.

2002-12-11  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* libpostgres.c: Update copyright.
	No longer #include <postgres.h>.
	Include libpostgres.h using "" instead of <>.

	(rcsid): Delete.
	(ser_status_str_count): New var.
	(pg_guile_pg_rcsid): Delete.
	(str2symbol): New macro.
	(pg_result_status): Return symbol if available.

	* libpostgres_lo.c: Update copyright.

	(rcsid): Delete.
	(pg_guile_pg_lo_rcsid): Delete.
	(TTN_COERCE_INT): New macro.
	(lob_mklobport): Use SCM_INPUT_PORT_P instead of SCM_INPORTP.
	Use SCM_OUTPUT_PORT_P instead of SCM_OUTPORTP.
	Use TTN_COERCE_INT.
	(terminating): Make static.
	(lob_write): Use TTN_COERCE_INT.

	* scm/postgres.scm.in: Update copyright.
	Rework loading to use `make-app-module-loader' if available,
	emulating it if not.

	(pg-setdb): New export.
	(pg-guile-pg-module-rcsid, pg-guile-pg-rcsid): Delete.

	* scm/Makefile.am: Update copyright.

	(install-data-hook): New target.

	* test/basic-tests.sh, test/lo-tests.sh: Use dropdb if available,
	otherwise destroydb.
	No longer user guile-pg interpreter; instead use guile directly.

	* test/guile-pg-basic-tests.scm.in, test/guile-pg-lo-tests.scm.in:
	Update copyright.
	Use module (database postgres).
	Convert PGRES_foo references to symbols.

	* test/Makefile.am: Update copyright.
	(TESTS, EXTRA_DIST): Add alive.sh.
	(TESTS_ENVIRONMENT): New directive.

	* test/alive.sh: New file.

	* doc/guile-pg.texi: Update pg-result-status docs and examples.

2002-12-05  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* acinclude.m4 (GUILE_MODULE): Delete.

	* configure.in: No longer use GUILE_MODULE.
	Instead, use GUILE_PROGS and GUILE_FLAGS.

2002-12-05  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* .cvsignore, doc/.cvsignore, scm/.cvsignore, test/.cvsignore:
	New files.

	* HACKING: Remove RCS tag.
	Refill.
	Add "Quick start" commands.
	Update "I" to "we".
	Remove hints available elsewhere.

	* README: Update tested PostgreSQL version number.
	Update bug report email address.

2002-12-05  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* guile-pg.h, guile-pg.c: Delete.

	* Makefile.am: Update copyright.
	(EXTRA_DIST): Add autogen.sh.
	(bin_PROGRAMS, guile_pg_SOURCES, guile_pg_LDADD, guile_pg_CFLAGS,
	guile_pg_LDFLAGS): Delete.
	(INCLUDES): Add "-I.".
	(pkglibversdir): New var.
	(pkglibvers_LTLIBRARIES): Renamed from `lib_LTLIBRARIES'.
	(.c.x): Update guile-snarf invocation to use "-o OUT IN" syntax.
	(CLEANFILES): New directive.

	* configure.in: Update copyright.
	(top_builddir_absolute): New var, AC_SUBST'd.
	(AC_INIT): Look for libpostgres.c instead of guile-pg.c.
	(AC_INIT_AUTOMAKE): Use version 0.07u8 to indicate "under development".

2002-12-05  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* acconfig.h, aclocal.m4, configure, Makefile.in, INSTALL, ANNOUNCE,
	config.guess, config.h.in, config.sub, install-sh, ltmain.sh,
	missing, mkinstalldirs, stamp-h.in, doc/Makefile.in, doc/texinfo.tex,
	scm/Makefile.in, test/Makefile.in: Delete.

	* autogen.sh: Take "--libtoolize" option;
	conditionalize libtoolize invocation.
	Pass "-I ." to aclocal.
	Pass "--force" to automake.
	Record dev box tool versions in comment.

2000-06-20  Ian Grant  <Ian.Grant@cl.cam.ac.uk>

	* libpostgres.c: Fixed use of soon-to-be-deprecated
	  scm_make_smob_type_mfpe.

2000-06-15  Ian Grant  <Ian.Grant@cl.cam.ac.uk>

	* libpostgres.c: Fixed use of deprecated scm_smobfuns struct.

	* libpostgres.c configure.in doc/guile-pg.texi
	  test/guile-pg-basic-tests.scm.in: Added pg-oid-value function.

2000-06-02  Ian Grant  <Ian.Grant@cl.cam.ac.uk>

	* ANNOUNCE: New file.

	* Bumped libtool interface number to 2 prior to release.

	* Printing a large object port now gives information about the
	  libpq file descriptor, the OID and the database connection to
	  which the port applies.

	* Fixed buffer overflow in print methods for connection and
	  results smobs.

	* Fixed fill_input bug and lob_printp of closed port.

	* Added test case for read-line (would've caught fill_input bug)

	* Changed libtool to new version 1.3.5

	* Updated autogen.sh

2000-05-30  Ian Grant  <Ian.Grant@cl.cam.ac.uk>

	* Fixed large object ports so that they work with the further
	  changes to the ports interface.

	  Note: because of this, guile-pg no-longer builds with guile
	  versions prior to 1.3.4

	* Changed all function names from pg:name to pg-name.  This
	  removes the need for a hacked texi2html so that is now gone.

	* Removed pq-setdb  entirely.  It has been replaced by
	  pq-connectdb which is much more flexible.

	* Changed the installation directory of libpostgres.so.  This
	  used to be in an architecture dependent subdirectory, with a
	  symbolic link from an architecture-independent directory, but
	  this was still not compatible with multiple architectures.
	  Instead we install the .so in the $(library) directory and
	  load it explicitly using the scheme interface to dlopen etc.

	* As part of the above, the module is now loaded using

	         (use-modules (database postgres))

	* Addded procedure pg-guile-pg-loaded.  This is a marker, the
	  presence of which guarantees that guile-pg is present.  This
	  is tested in postgres.scm to see whether the guile is plain
	  guile or the statically-linked guile-pg.

	* Updated README

	* Added <Dollar>Id<Dollar> all over the place in preparation
	  for CVS use.  Also added PG-MODULE-RCSID procedure to get
	  the RCS Id of the scheme module (postgres.scm).

1999-06-27  Ian Grant  <Ian.Grant@cl.cam.ac.uk>

	* Changes to configure.in to check for Postgres 6.4 features.

	* Changes to libpostgres.c to conditionally compile procedures
	  depending on post 6.4 functionality in libpq.

	* Split libpostgres.c into two files. Added libpostgres_lo.c
	  containing the large object code.

	* Changes to libpostgres_lo.c to deal with Guile's new ptobfuns
	  interface. Changes to configure.in to detect the new ptobfuns
	  interface.

1999-01-31  Ian Grant  <Ian.Grant@cl.cam.ac.uk>

	* Changes to work with libpq from PostgreSQL 6.4.2 these were:

	* libpostgres.c: Added new primitives pg:binary-tuples? and pg:fmod.
	  Changed pg:error-message to work with either a PG-CONN or a
	  PG-RESULT object, calling PQresultErrorMessage in the latter case

	  Changed pg:getvalue to work with binary data. Now PQbinaryTuples
	  is called to check whether the returned value is binary and
	  if it is a string of the appropriate length is returned.

	  Changed pg:putline so that it actually calls PQputnbytes with
	  the correct length. This works with null-terminated strings
	  as it did before, but now works with strings containing embedded
	  nulls as well.

	* Makefile.am: Added -lcrypt to the dependency list for libpostgres.so
	  This is actually wrong though: -lcrypt should only be linked if
	  necessary, since it doesn't exist on some systems. We need to
	  check whether or not it exists in configure.in and only if does
	  should we include it. I don't have enough brains to do this
	  right now though.

1999-01-24  Ian Grant  <Ian.Grant@cl.cam.ac.uk>

	* HACKING: New File.

	* README: Added info on building guile-pg and intalling
	  PostgreSQL from the Red Hat RPMS.

	* test/guile-pg-basic-tests.scm: New file. Uses testing.scm in the
	  same directory.

	* test/guile-pg-lo-tests.scm: New file. Uses testing.scm in the
	  same directory.

	* Makefile.am, configure.in: Added test subdirectory.

1999-01-17  Ian Grant  <I.A.N.Grant@damtp.cam.ac.uk>

	* acinclude.m4: Added new macro definition GUILE_MODULE
	  which sets up the necessary install targets for a guile
	  module. It gets these from guile-config.

	* configure.in: Changed to use GUILE_MODULE.

	* libpostgres.c: Changed all scheme i/f functions to use
	  guile-snarf to make libpostgres.x

	* Makefile.am: Added lines to allow .x in .deps and to run
	  guile-snarf to create the .x files when necessary.

	* libpostgres.c: Added pg:reset and pg:trace and pg:untrace

1999-01-12  Ian Grant  <I.A.N.Grant@damtp.cam.ac.uk>

	* libpostgres.c: Completed large obect support

	* libpostgres.c: Added support for PQputline/PQgetline/PQendcopy

	* doc/guile-pg.texi: Function descriptions

1998-12-05  Ian Grant  <I.A.N.Grant@damtp.cam.ac.uk>

	* libtoolized

	* acinclude.m4: new file defining PQ library autoconf macro

1998-12-03  Ian Grant  <I.A.N.Grant@damtp.cam.ac.uk>

	* AUTHORS: New file, in accordance with the GNU maintainers'
	standards.

	* README: New file, in accordance with the GNU maintainers'
	standards.

	* Makefile.am: New file for automake.

	* configure.in and friends: new files for autoconf.
